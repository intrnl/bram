<!doctype html>
<html lang="en">

<title>A simple test</title>

<link href="https://unpkg.com/mocha@4.1.0/mocha.css" rel="stylesheet">
<script src="https://unpkg.com/chai/chai.js"></script>
<script src="https://unpkg.com/mocha@4.1.0/mocha.js"></script>
<style>
  .green { background: green; }
  .red { background: red; }
  .blue { background: blue; }
</style>

<template>
  <div id="color" class="{{color}}">
    <span id="name">{{name}}</span>
  </div>
</template>
<div id="main"></div>
<div id="mocha"></div>

<script>
  mocha.setup('bdd');
  assert = chai.assert;

  window.addEventListener('load', () => {
    mocha.run();
  });
</script>

<script type="module">
  import Bram from '../src/bram.js';

  let template = document.querySelector('template');
  let { fragment, model } = Bram.createInstance(template, {
    name: 'Wilbur',
    color: ''
  });

  window.model = model;
  document.querySelector('#main').appendChild(fragment);
</script>

<script type="module">
  describe('Template using attrs and textnodes', function(){
    let name = document.querySelector('#name');
    let color = document.querySelector('#color');
    let model = window.model;

    afterEach(function(){
      model.name = 'Wilbur';
      model.color = '';
    });

    it('The TextNode can be updated', function(){
      model.name = 'Matthew';
      assert.equal(name.textContent, 'Matthew');
    });

    it('Attributes can be changed', function(){
      model.color = 'green';
      let style = window.getComputedStyle(color);
      assert.equal(style.backgroundColor, 'rgb(0, 128, 0)');
    });
  });
</script>
